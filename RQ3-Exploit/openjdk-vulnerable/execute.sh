#!/bin/bash


JAVA_VERSION=$1
JAVA_CODE_PATH=$2
JAVA_CLASS_PATH=`echo ${JAVA_CODE} | cut -d'-' -f1`
echo ${JAVA_CLASS_PATH}
TARGET_JAR=$3

if [ ${#JAVA_VERSION} -eq 0 ];then
    echo "Needs one argument"
    exit 1
fi

if [ ${#JAVA_CODE} -eq 0 ];then
	echo "Needs one argument" 
	exit 1
fi  


if [ ! -d "$1" ];then
    echo "Argument needs to be related to an existing folder"	
    exit 1
fi


#fetch javac to compile
JAVA_BIN_PATH=`find  "${JAVA_VERSION}" -name "bin"`
JAVAC_BIN_PATH="${JAVA_BIN_PATH}/javac"
JAVA_EXEC_BIN_PATH="${JAVA_BIN_PATH}/java"
echo "_________________Building with:"
${JAVA_EXEC_BIN_PATH} -version
#execute with proper java binaryi
echo "_________________javac"
${JAVAC_BIN_PATH} ${JAVA_CODE_PATH}
echo "_________________java"
#target_jar_file=`find  -name ""`
target_jar_content=`cat ${TARGET_JAR}`
${JAVA_EXEC_BIN_PATH} ${JAVA_CLASS_PATH} ${TARGET_JAR}
